<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Last Week Sales</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Content-Security-Policy" content="script-src 'self'">
  <link rel="stylesheet" href="./style.css" />
  <style>
    /* small chart helpers (no external libs) */
    .card { background:#fff; border:1px solid #e0e0e0; border-radius:6px; padding:0.75rem; margin:0.75rem 0; }
    .chart-wrap { width:100%; overflow-x:auto; }
    canvas { width:100%; height:240px; display:block; }
    @media (max-width: 900px) and (orientation: landscape) {
      canvas { height:200px; }
    }
    .legend { font-size:.9rem; color:#5f6368; margin:.25rem 0 .5rem; }
    .muted { color:#5f6368; font-size:.85rem; }
    #top10 th:last-child,
    #top10 td:last-child { text-align: right; }
    @media print {
  /* Hide controls in print, optional: */
  header, #btnGo, #btnPrint, section[aria-label="filters"] { display: none !important; }

  /* Keep charts together on page 1 */
  .card { break-inside: avoid; }

  /* Force Top 10 card onto a new page (page 2) */
  #top10Card { break-before: page; }

  /* Make canvas crisp on print */
  canvas { height: auto !important; }
}
  </style>
</head>
<body>
  <header><h1>Last Week Sales</h1></header>
  <main>
    <section class="flex" aria-label="filters">
      <div class="input-group" style="max-width:420px;">
        <label for="dept">Sub-department</label>
        <select id="dept"></select>
      </div>
      <button id="btnGo">Submit</button>
      <button id="btnPrint" class="secondary">PRINT ðŸ–¶</button>
      <div class="muted" style="margin-left:auto;">Last complete week end: <span id="wkEnd">â€”</span></div>
    </section>

    <div id="info" class="page-info">Choose a sub-department (or All) and submit.</div>

    <h2 id="printSubdept" class="print-only"></h2>

    <div class="card">
      <div class="legend"><strong>Last 5 weeks</strong> (Sunâ€“Sat)</div>
      <canvas id="weeklyChart" role="img" aria-label="Sales totals for the last 5 complete weeks"></canvas>
    </div>

    <div class="card">
      <div class="legend"><strong>Last Two Weeks By Day</strong></div>
      <canvas id="compareChart" role="img" aria-label="Current week sales compared to previous week, day by day"></canvas>
      <div id="compareLegend" class="muted" style="margin-top:.25rem;"></div>
    </div>

    <div class="card" id="top10Card">
      <div class="legend"><strong>Top 10 items by sales last week ($)</strong></div>
      <div class="table-scroll">
        <table id="top10" style="width:100%;">
          <thead>
            <tr>
              <th>Item Code</th>
              <th>Brand</th>
              <th>Description</th>
              <th>Amount ($)</th>
            </tr>
          </thead>
          <tbody id="top10Body"></tbody>
        </table>
      </div>
    </div>
  </main>
  <script type="module" src="./department_sales.js?v=2"></script>
</body>
</html>
